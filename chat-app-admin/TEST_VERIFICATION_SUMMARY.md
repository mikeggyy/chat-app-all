# æ¸¬è©¦é©—è­‰è³‡æºæ‘˜è¦

æœ¬æ–‡æª”æä¾›æ‰€æœ‰æ¸¬è©¦è³‡æºçš„å¿«é€Ÿåƒè€ƒã€‚

---

## ğŸ“ æ¸¬è©¦æ–‡ä»¶åˆ—è¡¨

### 1. é€Ÿç‡é™åˆ¶å™¨æ¸¬è©¦è…³æœ¬
**æ–‡ä»¶**: `backend/scripts/test-rate-limiter.js`

**ç”¨é€”**: è‡ªå‹•æ¸¬è©¦é€Ÿç‡é™åˆ¶å™¨æ˜¯å¦æ­£ç¢ºæ‡‰ç”¨åˆ° API ç«¯é»

**å¿«é€Ÿé–‹å§‹**:
```bash
# è¨­ç½® Token
export ADMIN_TOKEN="your-firebase-auth-token"

# å¿«é€Ÿæ¸¬è©¦ï¼ˆæ¨è–¦ï¼‰
node backend/scripts/test-rate-limiter.js quick

# å®Œæ•´æ¸¬è©¦ï¼ˆæœƒè§¸ç™¼é€Ÿç‡é™åˆ¶ï¼‰
node backend/scripts/test-rate-limiter.js full
```

---

### 2. useVariableEditor æ¸¬è©¦æ–‡ä»¶
**æ–‡ä»¶**: `frontend/src/composables/useVariableEditor.test.js`

**ç”¨é€”**: æ¸¬è©¦ useVariableEditor composable çš„é‚Šç•Œæƒ…æ³è™•ç†

**å¿«é€Ÿé–‹å§‹**:
```bash
# Node.js ç’°å¢ƒ
node frontend/src/composables/useVariableEditor.test.js

# æˆ–åœ¨ç€è¦½å™¨æ§åˆ¶å°
runVariableEditorTests()
```

---

### 3. æ¸¬è©¦é©—è­‰æŒ‡å—
**æ–‡ä»¶**: `TESTING_GUIDE.md`

**ç”¨é€”**: å®Œæ•´çš„æ¸¬è©¦æŒ‡å—ï¼ŒåŒ…å«æ‰€æœ‰æ¸¬è©¦æ–¹æ³•å’Œæ•…éšœæ’é™¤

**å…§å®¹**:
- é€Ÿç‡é™åˆ¶å™¨æ¸¬è©¦ï¼ˆ3 ç¨®æ–¹æ³•ï¼‰
- useVariableEditor æ¸¬è©¦ï¼ˆ3 ç¨®æ–¹æ³•ï¼‰
- å‰ç«¯éŒ¯èª¤è™•ç†æ¸¬è©¦
- æ•…éšœæ’é™¤æŒ‡å—
- æ¸¬è©¦å ±å‘Šæ¨¡æ¿

---

## ğŸš€ å¿«é€Ÿæ¸¬è©¦æµç¨‹

### æœ€å¿«é€Ÿåº¦ï¼ˆ5 åˆ†é˜ï¼‰

**ç›®æ¨™**: å¿«é€Ÿé©—è­‰ä¿®å¾©æ˜¯å¦æœ‰æ•ˆ

```bash
# 1. å•Ÿå‹•æœå‹™
cd backend && npm run dev &
cd frontend && npm run dev &

# 2. è¨­ç½® Token
export ADMIN_TOKEN="your-token"

# 3. é€Ÿç‡é™åˆ¶å™¨å¿«é€Ÿæ¸¬è©¦
node backend/scripts/test-rate-limiter.js quick

# 4. useVariableEditor æ¸¬è©¦
node frontend/src/composables/useVariableEditor.test.js
```

**é æœŸæ™‚é–“**: 3-5 åˆ†é˜
**è¦†è“‹ç‡**: åŸºæœ¬åŠŸèƒ½é©—è­‰

---

### æ¨™æº–æ¸¬è©¦ï¼ˆ15 åˆ†é˜ï¼‰

**ç›®æ¨™**: å…¨é¢æ¸¬è©¦æ‰€æœ‰ä¿®å¾©

```bash
# 1. å•Ÿå‹•æœå‹™
cd backend && npm run dev
# åœ¨å¦ä¸€å€‹çµ‚ç«¯
cd frontend && npm run dev

# 2. è¨­ç½® Token
export ADMIN_TOKEN="your-token"

# 3. å®Œæ•´é€Ÿç‡é™åˆ¶å™¨æ¸¬è©¦
node backend/scripts/test-rate-limiter.js full

# 4. useVariableEditor è‡ªå‹•æ¸¬è©¦
node frontend/src/composables/useVariableEditor.test.js

# 5. æ‰‹å‹•æ¸¬è©¦å‰ç«¯
# è¨ªå• http://localhost:5174/ai-settings
# æ¸¬è©¦å„ç¨®é‚Šç•Œæƒ…æ³ï¼ˆè¦‹æ¸¬è©¦æŒ‡å—ï¼‰

# 6. è§¸ç™¼ä¸¦é©—è­‰ 429 éŒ¯èª¤
# ä½¿ç”¨ Postman æˆ– curl å¿«é€Ÿç™¼é€è¶…éé™åˆ¶çš„è«‹æ±‚
```

**é æœŸæ™‚é–“**: 10-15 åˆ†é˜
**è¦†è“‹ç‡**: å®Œæ•´åŠŸèƒ½é©—è­‰

---

### æ·±åº¦æ¸¬è©¦ï¼ˆ30+ åˆ†é˜ï¼‰

**ç›®æ¨™**: å…¨é¢æ¸¬è©¦ + å£“åŠ›æ¸¬è©¦ + å¯¦éš›ä½¿ç”¨å ´æ™¯

åŒ…æ‹¬ï¼š
- æ‰€æœ‰è‡ªå‹•åŒ–æ¸¬è©¦
- æ‰€æœ‰æ‰‹å‹•æ¸¬è©¦
- å¯¦éš›ä½¿ç”¨å ´æ™¯æ¸¬è©¦
- å¤šå€‹ç®¡ç†å“¡ä¸¦ç™¼æ¸¬è©¦
- é‚Šç•Œæƒ…æ³æ¢ç´¢

åƒè€ƒï¼š`TESTING_GUIDE.md` çš„å®Œæ•´æµç¨‹

---

## âœ… æ¸¬è©¦æª¢æŸ¥æ¸…å–®

### é€Ÿç‡é™åˆ¶å™¨ âœ“

- [x] å‰µå»ºæ¸¬è©¦è…³æœ¬: `backend/scripts/test-rate-limiter.js`
- [ ] å¿«é€Ÿæ¸¬è©¦é€šéï¼ˆ5/5 ç«¯é»æœ‰é€Ÿç‡é™åˆ¶é ­ï¼‰
- [ ] å®Œæ•´æ¸¬è©¦é€šéï¼ˆèƒ½è§¸ç™¼ 429 éŒ¯èª¤ï¼‰
- [ ] éŒ¯èª¤æ¶ˆæ¯ç‚ºä¸­æ–‡
- [ ] éŒ¯èª¤æ ¼å¼æ­£ç¢ºï¼ˆåŒ…å« error å’Œ messageï¼‰

**é©—è­‰å‘½ä»¤**:
```bash
export ADMIN_TOKEN="your-token"
node backend/scripts/test-rate-limiter.js quick
```

---

### useVariableEditor âœ“

- [x] å‰µå»ºæ¸¬è©¦æ–‡ä»¶: `frontend/src/composables/useVariableEditor.test.js`
- [ ] è‡ªå‹•æ¸¬è©¦é€šéï¼ˆ20/20ï¼‰
- [ ] null/undefined ä¸å°è‡´å´©æ½°
- [ ] éŒ¯èª¤è™•ç†æ­£ç¢ºï¼ˆtry-catch å·¥ä½œï¼‰
- [ ] å¯¦éš›ä½¿ç”¨å ´æ™¯æ­£å¸¸

**é©—è­‰å‘½ä»¤**:
```bash
node frontend/src/composables/useVariableEditor.test.js
```

---

### å‰ç«¯éŒ¯èª¤è™•ç† âœ“

- [ ] 429 éŒ¯èª¤è¢«æ­£ç¢ºæ•ç²
- [ ] Element Plus éŒ¯èª¤æç¤ºé¡¯ç¤º
- [ ] éŒ¯èª¤æ¶ˆæ¯æ¸…æ™°æ˜“æ‡‚
- [ ] ä¸å½±éŸ¿å…¶ä»–åŠŸèƒ½

**é©—è­‰æ–¹æ³•**:
1. è§¸ç™¼é€Ÿç‡é™åˆ¶ï¼ˆä½¿ç”¨æ¸¬è©¦è…³æœ¬ full æ¨¡å¼ï¼‰
2. åœ¨å‰ç«¯æ“ä½œæ™‚è§€å¯ŸéŒ¯èª¤æç¤º
3. æª¢æŸ¥ç€è¦½å™¨æ§åˆ¶å°

---

## ğŸ“Š é æœŸæ¸¬è©¦çµæœ

### é€Ÿç‡é™åˆ¶å™¨å¿«é€Ÿæ¸¬è©¦

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
å¿«é€Ÿæ¸¬è©¦ï¼šé©—è­‰é€Ÿç‡é™åˆ¶å™¨å·²æ‡‰ç”¨
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ“ GET /api/users/:userId: å·²æ‡‰ç”¨é€Ÿç‡é™åˆ¶å™¨
  X-RateLimit-Limit: 200
  X-RateLimit-Remaining: 199

âœ“ PATCH /api/users/:userId/usage-limits: å·²æ‡‰ç”¨é€Ÿç‡é™åˆ¶å™¨
  X-RateLimit-Limit: 100
  X-RateLimit-Remaining: 99

âœ“ GET /api/users/:userId/potions/details: å·²æ‡‰ç”¨é€Ÿç‡é™åˆ¶å™¨
  X-RateLimit-Limit: 200
  X-RateLimit-Remaining: 199

âœ“ GET /api/users/:userId/potion-effects: å·²æ‡‰ç”¨é€Ÿç‡é™åˆ¶å™¨
  X-RateLimit-Limit: 200
  X-RateLimit-Remaining: 199

âœ“ GET /api/users/:userId/resource-limits: å·²æ‡‰ç”¨é€Ÿç‡é™åˆ¶å™¨
  X-RateLimit-Limit: 200
  X-RateLimit-Remaining: 199

å¿«é€Ÿæ¸¬è©¦çµæœ
  é€šé: 5/5

âœ“ æ‰€æœ‰ç«¯é»éƒ½å·²æ­£ç¢ºæ‡‰ç”¨é€Ÿç‡é™åˆ¶å™¨
```

---

### useVariableEditor æ¸¬è©¦

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  useVariableEditor é‚Šç•Œæƒ…æ³æ¸¬è©¦å¥—ä»¶          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

=== æ¸¬è©¦ textToEditorContent é‚Šç•Œæƒ…æ³ ===

âœ“ ç©ºæ–‡æœ¬æ‡‰è¿”å›ç©ºæ®µè½
âœ“ null æ–‡æœ¬æ‡‰è¿”å›ç©ºæ®µè½
âœ“ undefined æ–‡æœ¬æ‡‰è¿”å›ç©ºæ®µè½
âœ“ variables ç‚º null æ™‚æ‡‰å°‡è®Šæ•¸è¦–ç‚ºæ™®é€šæ–‡æœ¬
âœ“ variables ç‚º undefined æ™‚æ‡‰å°‡è®Šæ•¸è¦–ç‚ºæ™®é€šæ–‡æœ¬
âœ“ variables æ•¸çµ„ä¸­çš„ null/undefined æ‡‰è¢«éæ¿¾
âœ“ ç¼ºå°‘ name çš„å°è±¡æ‡‰è¢«éæ¿¾
âœ“ æœ‰æ•ˆè®Šæ•¸æ‡‰æ­£ç¢ºè§£æ
âœ“ ä¸åœ¨åˆ—è¡¨ä¸­çš„è®Šæ•¸æ‡‰è¦–ç‚ºæ™®é€šæ–‡æœ¬
âœ“ å¤šå€‹è®Šæ•¸æ‡‰æ­£ç¢ºè§£æ

=== æ¸¬è©¦ editorContentToText é‚Šç•Œæƒ…æ³ ===

âœ“ null editor æ‡‰è¿”å›ç©ºå­—ç¬¦ä¸²
âœ“ undefined editor æ‡‰è¿”å›ç©ºå­—ç¬¦ä¸²
âœ“ getJSON() æ‹‹å‡ºç•°å¸¸æ™‚æ‡‰è¿”å›ç©ºå­—ç¬¦ä¸²
âœ“ æ­£å¸¸å…§å®¹æ‡‰æ­£ç¢ºè½‰æ›
âœ“ ç¼ºå°‘ attrs çš„ variable æ‡‰è¿”å›ç©ºå­—ç¬¦ä¸²
âœ“ attrs ç‚º null çš„ variable æ‡‰è¿”å›ç©ºå­—ç¬¦ä¸²
âœ“ ç¼ºå°‘ text å±¬æ€§çš„ text ç¯€é»æ‡‰è¿”å›ç©ºå­—ç¬¦ä¸²
âœ“ å¤šæ®µè½æ‡‰æ­£ç¢ºæ·»åŠ æ›è¡Œç¬¦
âœ“ ç©ºæ®µè½æ‡‰è¿”å›ç©ºå­—ç¬¦ä¸²
âœ“ åµŒå¥—å…§å®¹æ‡‰æ­£ç¢ºè™•ç†

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              æ¸¬è©¦å ±å‘Š                         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ç¸½æ¸¬è©¦æ•¸: 20
âœ“ é€šé: 20
âœ— å¤±æ•—: 0
é€šéç‡: 100%

âœ“ æ‰€æœ‰æ¸¬è©¦é€šéï¼é‚Šç•Œæƒ…æ³è™•ç†æ­£ç¢ºã€‚
```

---

## ğŸ› å¸¸è¦‹å•é¡Œ

### Q: æ¸¬è©¦è…³æœ¬å ±éŒ¯ "ADMIN_TOKEN not set"

**A**: éœ€è¦è¨­ç½®ç®¡ç†å“¡ Token
```bash
export ADMIN_TOKEN="your-firebase-auth-token"
```

ç²å– Token çš„æ–¹æ³•è¦‹ `TESTING_GUIDE.md`

---

### Q: æ‰€æœ‰è«‹æ±‚éƒ½è¿”å› 401

**A**: Token ç„¡æ•ˆæˆ–éæœŸ
- Firebase Token æœ‰æ•ˆæœŸ 1 å°æ™‚
- ç¢ºèªç”¨æˆ¶æœ‰ç®¡ç†å“¡æ¬Šé™ï¼ˆCustom Claimsï¼‰
- é‡æ–°ç²å– Token

---

### Q: æ¸¬è©¦ç„¡æ³•è§¸ç™¼é€Ÿç‡é™åˆ¶

**A**: å¯èƒ½åŸå› ï¼š
1. ä¸åŒ Token æœ‰ä¸åŒé…é¡
2. é€Ÿç‡é™åˆ¶çª—å£å·²é‡ç½®
3. æª¢æŸ¥éŸ¿æ‡‰é ­ç¢ºèªé€Ÿç‡é™åˆ¶å™¨æ˜¯å¦æ‡‰ç”¨

---

### Q: useVariableEditor æ¸¬è©¦å¤±æ•—

**A**: ç¢ºèªï¼š
1. æ–‡ä»¶è·¯å¾‘æ­£ç¢º
2. import è·¯å¾‘æ­£ç¢ºï¼ˆç›¸å°è·¯å¾‘ï¼‰
3. Node.js ç‰ˆæœ¬æ”¯æŒ ESM

---

## ğŸ“ æ¸¬è©¦å ±å‘Š

æ¸¬è©¦å®Œæˆå¾Œï¼Œè«‹å¡«å¯«å ±å‘Šä¸¦æäº¤ï¼š

```bash
# è¤‡è£½æ¨¡æ¿
cp TESTING_GUIDE.md TEST_RESULTS_$(date +%Y%m%d).md

# ç·¨è¼¯å¡«å¯«æ¸¬è©¦çµæœ
vim TEST_RESULTS_$(date +%Y%m%d).md

# æäº¤
git add TEST_RESULTS_$(date +%Y%m%d).md
git commit -m "test: æ·»åŠ æ¸¬è©¦çµæœå ±å‘Š"
```

---

## ğŸ¯ ä¸‹ä¸€æ­¥

æ¸¬è©¦é€šéå¾Œï¼š

1. âœ… æäº¤æ¸¬è©¦çµæœ
2. âœ… æ›´æ–° CHANGELOG.md
3. âœ… éƒ¨ç½²åˆ°æ¸¬è©¦ç’°å¢ƒ
4. âœ… ç›£æ§ç”Ÿç”¢ç’°å¢ƒ

---

## ğŸ“ æ”¯æŒ

éœ€è¦å¹«åŠ©ï¼Ÿ

1. æŸ¥çœ‹ `TESTING_GUIDE.md` çš„æ•…éšœæ’é™¤éƒ¨åˆ†
2. æª¢æŸ¥å¾Œç«¯æ—¥èªŒ
3. æª¢æŸ¥ç€è¦½å™¨æ§åˆ¶å°
4. æŸ¥çœ‹ Firebase Console

---

**å‰µå»ºæ—¥æœŸ**: 2025-01-13
**ç‰ˆæœ¬**: 1.0.0
**æœ€å¾Œæ›´æ–°**: 2025-01-13
