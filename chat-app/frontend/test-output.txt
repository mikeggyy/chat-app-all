
> frontend@0.0.0 test
> vitest usePotionManagement.spec.ts


[1m[46m RUN [49m[22m [36mv4.0.8 [39m[90mD:/project/chat-app-all/chat-app/frontend[39m

[90mstdout[2m | src/composables/chat/usePotionManagement.spec.ts[2m > [22m[2musePotionManagement - è—¥æ°´ç®¡ç†æ¸¬è©¦[2m > [22m[2mloadActivePotions[2m > [22m[2mæ‡‰è©²æˆåŠŸè¼‰å…¥æ´»èºè—¥æ°´æ•ˆæœ
[22m[39m[loadActivePotions] API è¿”å›æ•¸æ“š: {
  potions: [
    {
      potionType: [32m'memory_boost'[39m,
      characterId: [32m'char-001'[39m,
      expiresAt: [32m'2025-01-20'[39m
    },
    {
      potionType: [32m'brain_boost'[39m,
      characterId: [32m'char-002'[39m,
      expiresAt: [32m'2025-01-22'[39m
    }
  ]
}
[loadActivePotions] è¨­ç½® activePotionEffects: [
  {
    potionType: [32m'memory_boost'[39m,
    characterId: [32m'char-001'[39m,
    expiresAt: [32m'2025-01-20'[39m
  },
  {
    potionType: [32m'brain_boost'[39m,
    characterId: [32m'char-002'[39m,
    expiresAt: [32m'2025-01-22'[39m
  }
]

[90mstdout[2m | src/composables/chat/usePotionManagement.spec.ts[2m > [22m[2musePotionManagement - è—¥æ°´ç®¡ç†æ¸¬è©¦[2m > [22m[2mloadActivePotions[2m > [22m[2mæ‡‰è©²åœ¨è¼‰å…¥å‰æ¸…ç©ºèˆŠæ•¸æ“š
[22m[39m[loadActivePotions] API è¿”å›æ•¸æ“š: { potions: [ { potionType: [32m'brain_boost'[39m, characterId: [32m'new-char'[39m } ] }
[loadActivePotions] è¨­ç½® activePotionEffects: [ { potionType: [32m'brain_boost'[39m, characterId: [32m'new-char'[39m } ]

[90mstderr[2m | src/composables/chat/usePotionManagement.spec.ts[2m > [22m[2musePotionManagement - è—¥æ°´ç®¡ç†æ¸¬è©¦[2m > [22m[2mloadActivePotions[2m > [22m[2mæ‡‰è©²éœé»˜è™•ç†è¼‰å…¥éŒ¯èª¤
[22m[39m[loadActivePotions] åŠ è¼‰å¤±æ•—: Error: API error
    at D:/project/chat-app-all/chat-app/frontend/src/composables/chat/usePotionManagement.spec.ts:255:56
    at [90mfile:///D:/project/chat-app-all/chat-app/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:157:11
    at [90mfile:///D:/project/chat-app-all/chat-app/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:753:26
    at [90mfile:///D:/project/chat-app-all/chat-app/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1636:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/project/chat-app-all/chat-app/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1602:10[90m)[39m
    at runTest [90m(file:///D:/project/chat-app-all/chat-app/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1309:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///D:/project/chat-app-all/chat-app/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1468:8[90m)[39m
    at runSuite [90m(file:///D:/project/chat-app-all/chat-app/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1468:8[90m)[39m

[90mstdout[2m | src/composables/chat/usePotionManagement.spec.ts[2m > [22m[2musePotionManagement - è—¥æ°´ç®¡ç†æ¸¬è©¦[2m > [22m[2musePotion[2m > [22m[2mæ‡‰è©²æˆåŠŸä½¿ç”¨è¨˜æ†¶å¢å¼·è—¥æ°´
[22m[39m[loadActivePotions] API è¿”å›æ•¸æ“š: { potions: [] }
[loadActivePotions] è¨­ç½® activePotionEffects: []

[90mstdout[2m | src/composables/chat/usePotionManagement.spec.ts[2m > [22m[2musePotionManagement - è—¥æ°´ç®¡ç†æ¸¬è©¦[2m > [22m[2musePotion[2m > [22m[2mæ‡‰è©²æˆåŠŸä½¿ç”¨è…¦åŠ›æ¿€ç›ªè—¥æ°´
[22m[39m[loadActivePotions] API è¿”å›æ•¸æ“š: { potions: [] }
[loadActivePotions] è¨­ç½® activePotionEffects: []

[90mstderr[2m | src/composables/chat/usePotionManagement.spec.ts[2m > [22m[2musePotionManagement - è—¥æ°´ç®¡ç†æ¸¬è©¦[2m > [22m[2musePotion[2m > [22m[2mæ‡‰è©²è™•ç† API éŒ¯èª¤
[22m[39m[ä½¿ç”¨è—¥æ°´éŒ¯èª¤] Error: ä½¿ç”¨å¤±æ•—
    at D:/project/chat-app-all/chat-app/frontend/src/composables/chat/usePotionManagement.spec.ts:348:56
    at [90mfile:///D:/project/chat-app-all/chat-app/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:157:11
    at [90mfile:///D:/project/chat-app-all/chat-app/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:753:26
    at [90mfile:///D:/project/chat-app-all/chat-app/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1636:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/project/chat-app-all/chat-app/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1602:10[90m)[39m
    at runTest [90m(file:///D:/project/chat-app-all/chat-app/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1309:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///D:/project/chat-app-all/chat-app/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1468:8[90m)[39m
    at runSuite [90m(file:///D:/project/chat-app-all/chat-app/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1468:8[90m)[39m

[90mstdout[2m | src/composables/chat/usePotionManagement.spec.ts[2m > [22m[2musePotionManagement - è—¥æ°´ç®¡ç†æ¸¬è©¦[2m > [22m[2musePotion[2m > [22m[2mæ‡‰è©²åœ¨ä½¿ç”¨æˆåŠŸå¾Œé‡æ–°è¼‰å…¥è—¥æ°´å’Œæ•ˆæœ
[22m[39m[loadActivePotions] API è¿”å›æ•¸æ“š: { potions: [] }
[loadActivePotions] è¨­ç½® activePotionEffects: []

[90mstdout[2m | src/composables/chat/usePotionManagement.spec.ts[2m > [22m[2musePotionManagement - è—¥æ°´ç®¡ç†æ¸¬è©¦[2m > [22m[2mhandleConfirmUsePotion[2m > [22m[2mæ‡‰è©²æˆåŠŸç¢ºèªä¸¦ä½¿ç”¨è—¥æ°´
[22m[39m[loadActivePotions] API è¿”å›æ•¸æ“š: { potions: [] }
[loadActivePotions] è¨­ç½® activePotionEffects: []

[90mstderr[2m | src/composables/chat/usePotionManagement.spec.ts[2m > [22m[2musePotionManagement - è—¥æ°´ç®¡ç†æ¸¬è©¦[2m > [22m[2mhandleConfirmUsePotion[2m > [22m[2mæ‡‰è©²åœ¨ä½¿ç”¨å¤±æ•—æ™‚ä¸é—œé–‰å½ˆçª—
[22m[39m[ä½¿ç”¨è—¥æ°´éŒ¯èª¤] Error: ä½¿ç”¨å¤±æ•—
    at D:/project/chat-app-all/chat-app/frontend/src/composables/chat/usePotionManagement.spec.ts:410:56
    at [90mfile:///D:/project/chat-app-all/chat-app/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:157:11
    at [90mfile:///D:/project/chat-app-all/chat-app/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:753:26
    at [90mfile:///D:/project/chat-app-all/chat-app/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1636:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/project/chat-app-all/chat-app/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1602:10[90m)[39m
    at runTest [90m(file:///D:/project/chat-app-all/chat-app/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1309:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///D:/project/chat-app-all/chat-app/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1468:8[90m)[39m
    at runSuite [90m(file:///D:/project/chat-app-all/chat-app/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1468:8[90m)[39m

[90mstderr[2m | src/composables/chat/usePotionManagement.spec.ts[2m > [22m[2musePotionManagement - è—¥æ°´ç®¡ç†æ¸¬è©¦[2m > [22m[2mhandleConfirmUsePotion[2m > [22m[2mæ‡‰è©²ç¢ºä¿ finally æ¸…é™¤ loading ç‹€æ…‹
[22m[39m[ä½¿ç”¨è—¥æ°´éŒ¯èª¤] Error: ä½¿ç”¨å¤±æ•—
    at D:/project/chat-app-all/chat-app/frontend/src/composables/chat/usePotionManagement.spec.ts:419:56
    at [90mfile:///D:/project/chat-app-all/chat-app/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:157:11
    at [90mfile:///D:/project/chat-app-all/chat-app/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:753:26
    at [90mfile:///D:/project/chat-app-all/chat-app/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1636:20
    at new Promise (<anonymous>)
    at runWithTimeout [90m(file:///D:/project/chat-app-all/chat-app/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1602:10[90m)[39m
    at runTest [90m(file:///D:/project/chat-app-all/chat-app/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1309:12[90m)[39m
[90m    at processTicksAndRejections (node:internal/process/task_queues:105:5)[39m
    at runSuite [90m(file:///D:/project/chat-app-all/chat-app/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1468:8[90m)[39m
    at runSuite [90m(file:///D:/project/chat-app-all/chat-app/frontend/[39mnode_modules/[4m@vitest[24m/runner/dist/index.js:1468:8[90m)[39m

[90mstdout[2m | src/composables/chat/usePotionManagement.spec.ts[2m > [22m[2musePotionManagement - è—¥æ°´ç®¡ç†æ¸¬è©¦[2m > [22m[2mComputed å±¬æ€§[2m > [22m[2mactiveMemoryBoost æ‡‰è©²è¿”å›ç•¶å‰è§’è‰²çš„è¨˜æ†¶å¢å¼·æ•ˆæœ
[22m[39m[loadActivePotions] API è¿”å›æ•¸æ“š: {
  potions: [
    {
      potionType: [32m'memory_boost'[39m,
      characterId: [32m'char-001'[39m,
      expiresAt: [32m'2025-01-20'[39m
    },
    {
      potionType: [32m'brain_boost'[39m,
      characterId: [32m'char-001'[39m,
      expiresAt: [32m'2025-01-22'[39m
    },
    {
      potionType: [32m'memory_boost'[39m,
      characterId: [32m'char-002'[39m,
      expiresAt: [32m'2025-01-21'[39m
    }
  ]
}
[loadActivePotions] è¨­ç½® activePotionEffects: [
  {
    potionType: [32m'memory_boost'[39m,
    characterId: [32m'char-001'[39m,
    expiresAt: [32m'2025-01-20'[39m
  },
  {
    potionType: [32m'brain_boost'[39m,
    characterId: [32m'char-001'[39m,
    expiresAt: [32m'2025-01-22'[39m
  },
  {
    potionType: [32m'memory_boost'[39m,
    characterId: [32m'char-002'[39m,
    expiresAt: [32m'2025-01-21'[39m
  }
]

[90mstdout[2m | src/composables/chat/usePotionManagement.spec.ts[2m > [22m[2musePotionManagement - è—¥æ°´ç®¡ç†æ¸¬è©¦[2m > [22m[2mComputed å±¬æ€§[2m > [22m[2mactiveMemoryBoost æ‡‰è©²è¿”å›ç•¶å‰è§’è‰²çš„è¨˜æ†¶å¢å¼·æ•ˆæœ
[22m[39m[activeMemoryBoost] partnerId: char-001
[activeMemoryBoost] activePotionEffects: [
  {
    potionType: [32m'memory_boost'[39m,
    characterId: [32m'char-001'[39m,
    expiresAt: [32m'2025-01-20'[39m
  },
  {
    potionType: [32m'brain_boost'[39m,
    characterId: [32m'char-001'[39m,
    expiresAt: [32m'2025-01-22'[39m
  },
  {
    potionType: [32m'memory_boost'[39m,
    characterId: [32m'char-002'[39m,
    expiresAt: [32m'2025-01-21'[39m
  }
]
[activeMemoryBoost] æ‰¾åˆ°çš„æ•ˆæœ: {
  potionType: [32m'memory_boost'[39m,
  characterId: [32m'char-001'[39m,
  expiresAt: [32m'2025-01-20'[39m
}

[90mstdout[2m | src/composables/chat/usePotionManagement.spec.ts[2m > [22m[2musePotionManagement - è—¥æ°´ç®¡ç†æ¸¬è©¦[2m > [22m[2mComputed å±¬æ€§[2m > [22m[2mactiveBrainBoost æ‡‰è©²è¿”å›ç•¶å‰è§’è‰²çš„è…¦åŠ›æ¿€ç›ªæ•ˆæœ
[22m[39m[loadActivePotions] API è¿”å›æ•¸æ“š: {
  potions: [
    {
      potionType: [32m'brain_boost'[39m,
      characterId: [32m'char-001'[39m,
      expiresAt: [32m'2025-01-22'[39m
    },
    {
      potionType: [32m'memory_boost'[39m,
      characterId: [32m'char-001'[39m,
      expiresAt: [32m'2025-01-20'[39m
    }
  ]
}
[loadActivePotions] è¨­ç½® activePotionEffects: [
  {
    potionType: [32m'brain_boost'[39m,
    characterId: [32m'char-001'[39m,
    expiresAt: [32m'2025-01-22'[39m
  },
  {
    potionType: [32m'memory_boost'[39m,
    characterId: [32m'char-001'[39m,
    expiresAt: [32m'2025-01-20'[39m
  }
]

[90mstdout[2m | src/composables/chat/usePotionManagement.spec.ts[2m > [22m[2musePotionManagement - è—¥æ°´ç®¡ç†æ¸¬è©¦[2m > [22m[2mComputed å±¬æ€§[2m > [22m[2mactiveBrainBoost æ‡‰è©²è¿”å›ç•¶å‰è§’è‰²çš„è…¦åŠ›æ¿€ç›ªæ•ˆæœ
[22m[39m[activeBrainBoost] partnerId: char-001
[activeBrainBoost] activePotionEffects: [
  {
    potionType: [32m'brain_boost'[39m,
    characterId: [32m'char-001'[39m,
    expiresAt: [32m'2025-01-22'[39m
  },
  {
    potionType: [32m'memory_boost'[39m,
    characterId: [32m'char-001'[39m,
    expiresAt: [32m'2025-01-20'[39m
  }
]
[activeBrainBoost] Effect 0: {
  potionType: [32m'brain_boost'[39m,
  characterId: [32m'char-001'[39m,
  id: [90mundefined[39m,
  matches: [33mtrue[39m
}
[activeBrainBoost] Effect 1: {
  potionType: [32m'memory_boost'[39m,
  characterId: [32m'char-001'[39m,
  id: [90mundefined[39m,
  matches: [33mfalse[39m
}
[activeBrainBoost] æ‰¾åˆ°çš„æ•ˆæœ: {
  potionType: [32m'brain_boost'[39m,
  characterId: [32m'char-001'[39m,
  expiresAt: [32m'2025-01-22'[39m
}

[90mstdout[2m | src/composables/chat/usePotionManagement.spec.ts[2m > [22m[2musePotionManagement - è—¥æ°´ç®¡ç†æ¸¬è©¦[2m > [22m[2mComputed å±¬æ€§[2m > [22m[2mæ‡‰è©²åœ¨æ²’æœ‰åŒ¹é…æ•ˆæœæ™‚è¿”å› undefined
[22m[39m[loadActivePotions] API è¿”å›æ•¸æ“š: {
  potions: [
    {
      potionType: [32m'memory_boost'[39m,
      characterId: [32m'char-002'[39m,
      expiresAt: [32m'2025-01-20'[39m
    }
  ]
}
[loadActivePotions] è¨­ç½® activePotionEffects: [
  {
    potionType: [32m'memory_boost'[39m,
    characterId: [32m'char-002'[39m,
    expiresAt: [32m'2025-01-20'[39m
  }
]

[90mstdout[2m | src/composables/chat/usePotionManagement.spec.ts[2m > [22m[2musePotionManagement - è—¥æ°´ç®¡ç†æ¸¬è©¦[2m > [22m[2mComputed å±¬æ€§[2m > [22m[2mæ‡‰è©²åœ¨æ²’æœ‰åŒ¹é…æ•ˆæœæ™‚è¿”å› undefined
[22m[39m[activeMemoryBoost] partnerId: char-001
[activeMemoryBoost] activePotionEffects: [
  {
    potionType: [32m'memory_boost'[39m,
    characterId: [32m'char-002'[39m,
    expiresAt: [32m'2025-01-20'[39m
  }
]
[activeMemoryBoost] æ‰¾åˆ°çš„æ•ˆæœ: [90mundefined[39m
[activeBrainBoost] partnerId: char-001
[activeBrainBoost] activePotionEffects: [
  {
    potionType: [32m'memory_boost'[39m,
    characterId: [32m'char-002'[39m,
    expiresAt: [32m'2025-01-20'[39m
  }
]
[activeBrainBoost] Effect 0: {
  potionType: [32m'memory_boost'[39m,
  characterId: [32m'char-002'[39m,
  id: [90mundefined[39m,
  matches: [33mfalse[39m
}
[activeBrainBoost] æ‰¾åˆ°çš„æ•ˆæœ: [90mundefined[39m

[90mstdout[2m | src/composables/chat/usePotionManagement.spec.ts[2m > [22m[2musePotionManagement - è—¥æ°´ç®¡ç†æ¸¬è©¦[2m > [22m[2mComputed å±¬æ€§[2m > [22m[2mæ‡‰è©²åœ¨æ´»èºæ•ˆæœåˆ—è¡¨æ›´æ–°æ™‚é‡æ–°è¨ˆç®— computed
[22m[39m[loadActivePotions] API è¿”å›æ•¸æ“š: {
  potions: [
    {
      potionType: [32m'memory_boost'[39m,
      characterId: [32m'char-001'[39m,
      expiresAt: [32m'2025-01-20'[39m
    }
  ]
}
[loadActivePotions] è¨­ç½® activePotionEffects: [
  {
    potionType: [32m'memory_boost'[39m,
    characterId: [32m'char-001'[39m,
    expiresAt: [32m'2025-01-20'[39m
  }
]

[90mstdout[2m | src/composables/chat/usePotionManagement.spec.ts[2m > [22m[2musePotionManagement - è—¥æ°´ç®¡ç†æ¸¬è©¦[2m > [22m[2mComputed å±¬æ€§[2m > [22m[2mæ‡‰è©²åœ¨æ´»èºæ•ˆæœåˆ—è¡¨æ›´æ–°æ™‚é‡æ–°è¨ˆç®— computed
[22m[39m[activeMemoryBoost] partnerId: char-001
[activeMemoryBoost] activePotionEffects: [
  {
    potionType: [32m'memory_boost'[39m,
    characterId: [32m'char-001'[39m,
    expiresAt: [32m'2025-01-20'[39m
  }
]
[activeMemoryBoost] æ‰¾åˆ°çš„æ•ˆæœ: {
  potionType: [32m'memory_boost'[39m,
  characterId: [32m'char-001'[39m,
  expiresAt: [32m'2025-01-20'[39m
}

[90mstdout[2m | src/composables/chat/usePotionManagement.spec.ts[2m > [22m[2musePotionManagement - è—¥æ°´ç®¡ç†æ¸¬è©¦[2m > [22m[2mComputed å±¬æ€§[2m > [22m[2mæ‡‰è©²åœ¨æ´»èºæ•ˆæœåˆ—è¡¨æ›´æ–°æ™‚é‡æ–°è¨ˆç®— computed
[22m[39m[loadActivePotions] API è¿”å›æ•¸æ“š: {
  potions: [
    {
      potionType: [32m'memory_boost'[39m,
      characterId: [32m'char-001'[39m,
      expiresAt: [32m'2025-01-20'[39m
    },
    {
      potionType: [32m'memory_boost'[39m,
      characterId: [32m'char-002'[39m,
      expiresAt: [32m'2025-01-21'[39m
    }
  ]
}
[loadActivePotions] è¨­ç½® activePotionEffects: [
  {
    potionType: [32m'memory_boost'[39m,
    characterId: [32m'char-001'[39m,
    expiresAt: [32m'2025-01-20'[39m
  },
  {
    potionType: [32m'memory_boost'[39m,
    characterId: [32m'char-002'[39m,
    expiresAt: [32m'2025-01-21'[39m
  }
]

[90mstdout[2m | src/composables/chat/usePotionManagement.spec.ts[2m > [22m[2musePotionManagement - è—¥æ°´ç®¡ç†æ¸¬è©¦[2m > [22m[2mComputed å±¬æ€§[2m > [22m[2mæ‡‰è©²åœ¨æ´»èºæ•ˆæœåˆ—è¡¨æ›´æ–°æ™‚é‡æ–°è¨ˆç®— computed
[22m[39m[activeMemoryBoost] partnerId: char-001
[activeMemoryBoost] activePotionEffects: [
  {
    potionType: [32m'memory_boost'[39m,
    characterId: [32m'char-001'[39m,
    expiresAt: [32m'2025-01-20'[39m
  },
  {
    potionType: [32m'memory_boost'[39m,
    characterId: [32m'char-002'[39m,
    expiresAt: [32m'2025-01-21'[39m
  }
]
[activeMemoryBoost] æ‰¾åˆ°çš„æ•ˆæœ: {
  potionType: [32m'memory_boost'[39m,
  characterId: [32m'char-001'[39m,
  expiresAt: [32m'2025-01-20'[39m
}

[90mstdout[2m | src/composables/chat/usePotionManagement.spec.ts[2m > [22m[2musePotionManagement - è—¥æ°´ç®¡ç†æ¸¬è©¦[2m > [22m[2mé‚Šç•Œæƒ…æ³[2m > [22m[2mæ‡‰è©²è™•ç†ç©ºçš„æ´»èºæ•ˆæœéŸ¿æ‡‰
[22m[39m[loadActivePotions] API è¿”å›æ•¸æ“š: { potions: [] }
[loadActivePotions] è¨­ç½® activePotionEffects: []

[90mstderr[2m | src/composables/chat/usePotionManagement.spec.ts[2m > [22m[2musePotionManagement - è—¥æ°´ç®¡ç†æ¸¬è©¦[2m > [22m[2mé‚Šç•Œæƒ…æ³[2m > [22m[2mæ‡‰è©²è™•ç†éæ¨™æº–éŒ¯èª¤å°è±¡
[22m[39m[ä½¿ç”¨è—¥æ°´éŒ¯èª¤] å­—ç¬¦ä¸²éŒ¯èª¤

 [31mâ¯[39m src/composables/chat/usePotionManagement.spec.ts [2m([22m[2m30 tests[22m[2m | [22m[31m3 failed[39m[2m)[22m[32m 110[2mms[22m[39m
       [32mâœ“[39m æ‡‰è©²åˆå§‹åŒ–ç‚ºç©ºç‹€æ…‹[32m 63[2mms[22m[39m
       [32mâœ“[39m æ‡‰è©²æš´éœ²æ‰€æœ‰å¿…è¦çš„å±¬æ€§å’Œæ–¹æ³•[32m 1[2mms[22m[39m
       [32mâœ“[39m æ‡‰è©²æˆåŠŸè¼‰å…¥ç”¨æˆ¶è—¥æ°´æ•¸é‡[32m 3[2mms[22m[39m
       [32mâœ“[39m æ‡‰è©²è™•ç†ç¼ºå°‘æŸå€‹è—¥æ°´é¡å‹çš„æƒ…æ³[32m 1[2mms[22m[39m
       [32mâœ“[39m æ‡‰è©²åœ¨æ²’æœ‰ç”¨æˆ¶ ID æ™‚ä¸è¼‰å…¥[32m 1[2mms[22m[39m
       [32mâœ“[39m æ‡‰è©²éœé»˜è™•ç†è¼‰å…¥éŒ¯èª¤[32m 1[2mms[22m[39m
       [32mâœ“[39m æ‡‰è©²è™•ç† API è¿”å› null[32m 1[2mms[22m[39m
       [32mâœ“[39m æ‡‰è©²æˆåŠŸè¼‰å…¥æ´»èºè—¥æ°´æ•ˆæœ[32m 2[2mms[22m[39m
       [32mâœ“[39m æ‡‰è©²åœ¨è¼‰å…¥å‰æ¸…ç©ºèˆŠæ•¸æ“š[32m 2[2mms[22m[39m
       [32mâœ“[39m æ‡‰è©²åœ¨æ²’æœ‰ç”¨æˆ¶ ID æ™‚ä¸è¼‰å…¥[32m 1[2mms[22m[39m
       [32mâœ“[39m æ‡‰è©²éœé»˜è™•ç†è¼‰å…¥éŒ¯èª¤[32m 3[2mms[22m[39m
[31m       [31mÃ—[31m æ‡‰è©²æˆåŠŸä½¿ç”¨è¨˜æ†¶å¢å¼·è—¥æ°´[39m[32m 5[2mms[22m[39m
[31m       [31mÃ—[31m æ‡‰è©²æˆåŠŸä½¿ç”¨è…¦åŠ›æ¿€ç›ªè—¥æ°´[39m[32m 2[2mms[22m[39m
       [32mâœ“[39m æ‡‰è©²åœ¨æ²’æœ‰ç”¨æˆ¶ ID æ™‚æ‹’çµ•ä½¿ç”¨[32m 1[2mms[22m[39m
       [32mâœ“[39m æ‡‰è©²åœ¨æ²’æœ‰è§’è‰² ID æ™‚æ‹’çµ•ä½¿ç”¨[32m 1[2mms[22m[39m
       [32mâœ“[39m æ‡‰è©²æ‹’çµ•ç„¡æ•ˆçš„è—¥æ°´é¡å‹[32m 1[2mms[22m[39m
       [32mâœ“[39m æ‡‰è©²è™•ç† API éŒ¯èª¤[32m 1[2mms[22m[39m
       [32mâœ“[39m æ‡‰è©²åœ¨ä½¿ç”¨æˆåŠŸå¾Œé‡æ–°è¼‰å…¥è—¥æ°´å’Œæ•ˆæœ[32m 1[2mms[22m[39m
       [32mâœ“[39m æ‡‰è©²è™•ç† API è¿”å› success: false[32m 1[2mms[22m[39m
       [32mâœ“[39m æ‡‰è©²æˆåŠŸç¢ºèªä¸¦ä½¿ç”¨è—¥æ°´[32m 1[2mms[22m[39m
       [32mâœ“[39m æ‡‰è©²åœ¨æ²’æœ‰è—¥æ°´é¡å‹æ™‚é¡¯ç¤ºéŒ¯èª¤[32m 1[2mms[22m[39m
       [32mâœ“[39m æ‡‰è©²åœ¨ä½¿ç”¨å¤±æ•—æ™‚ä¸é—œé–‰å½ˆçª—[32m 2[2mms[22m[39m
       [32mâœ“[39m æ‡‰è©²ç¢ºä¿ finally æ¸…é™¤ loading ç‹€æ…‹[32m 1[2mms[22m[39m
       [32mâœ“[39m activeMemoryBoost æ‡‰è©²è¿”å›ç•¶å‰è§’è‰²çš„è¨˜æ†¶å¢å¼·æ•ˆæœ[32m 1[2mms[22m[39m
       [32mâœ“[39m activeBrainBoost æ‡‰è©²è¿”å›ç•¶å‰è§’è‰²çš„è…¦åŠ›æ¿€ç›ªæ•ˆæœ[32m 3[2mms[22m[39m
       [32mâœ“[39m æ‡‰è©²åœ¨æ²’æœ‰åŒ¹é…æ•ˆæœæ™‚è¿”å› undefined[32m 3[2mms[22m[39m
       [32mâœ“[39m æ‡‰è©²åœ¨æ´»èºæ•ˆæœåˆ—è¡¨æ›´æ–°æ™‚é‡æ–°è¨ˆç®— computed[32m 1[2mms[22m[39m
       [32mâœ“[39m æ‡‰è©²è™•ç†ç©ºçš„è—¥æ°´æ•¸é‡éŸ¿æ‡‰[32m 1[2mms[22m[39m
       [32mâœ“[39m æ‡‰è©²è™•ç†ç©ºçš„æ´»èºæ•ˆæœéŸ¿æ‡‰[32m 1[2mms[22m[39m
[31m       [31mÃ—[31m æ‡‰è©²è™•ç†éæ¨™æº–éŒ¯èª¤å°è±¡[39m[32m 1[2mms[22m[39m

[31mâ¯â¯â¯â¯â¯â¯â¯[39m[1m[41m Failed Tests 3 [49m[22m[31mâ¯â¯â¯â¯â¯â¯â¯[39m

[41m[1m FAIL [22m[49m src/composables/chat/usePotionManagement.spec.ts[2m > [22musePotionManagement - è—¥æ°´ç®¡ç†æ¸¬è©¦[2m > [22musePotion[2m > [22mæ‡‰è©²æˆåŠŸä½¿ç”¨è¨˜æ†¶å¢å¼·è—¥æ°´
[31m[1mAssertionError[22m: expected "vi.fn()" to be called with arguments: [ â€¦(2) ][90m

Received: 

[1m  1st vi.fn() call:

[22m[2m  [[22m
[2m    "/api/potions/use/memory-boost",[22m
[2m    {[22m
[2m      "body": {[22m
[2m        "characterId": "char-001",[22m
[31m+       "idempotencyKey": "1764136336729-x39rz",[90m
[2m      },[22m
[2m      "method": "POST",[22m
[2m    },[22m
[2m  ][22m

[1m  2nd vi.fn() call:

[22m[2m  [[22m
[32m-   "/api/potions/use/memory-boost",[90m
[31m+   "/api/potions/active",[90m
[2m    {[22m
[32m-     "body": {[90m
[32m-       "characterId": "char-001",[90m
[32m-     },[90m
[32m-     "method": "POST",[90m
[31m+     "skipGlobalLoading": true,[90m
[2m    },[22m
[2m  ][22m

[1m  3rd vi.fn() call:

[22m[2m  [[22m
[32m-   "/api/potions/use/memory-boost",[90m
[31m+   "/api/users/user-123/assets",[90m
[2m    {[22m
[32m-     "body": {[90m
[32m-       "characterId": "char-001",[90m
[32m-     },[90m
[32m-     "method": "POST",[90m
[31m+     "skipGlobalLoading": true,[90m
[2m    },[22m
[2m  ][22m
[31m[90m

Number of calls: [1m3[22m
[31m[39m
[36m [2mâ¯[22m src/composables/chat/usePotionManagement.spec.ts:[2m279:32[22m[39m
    [90m277| [39m
    [90m278| [39m      [34mexpect[39m(result)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m279| [39m      [34mexpect[39m(apiUtils[33m.[39mapiJson)[33m.[39m[34mtoHaveBeenCalledWith[39m(
    [90m   | [39m                               [31m^[39m
    [90m280| [39m        [32m'/api/potions/use/memory-boost'[39m[33m,[39m
    [90m281| [39m        {

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[1/3]â¯[22m[39m

[41m[1m FAIL [22m[49m src/composables/chat/usePotionManagement.spec.ts[2m > [22musePotionManagement - è—¥æ°´ç®¡ç†æ¸¬è©¦[2m > [22musePotion[2m > [22mæ‡‰è©²æˆåŠŸä½¿ç”¨è…¦åŠ›æ¿€ç›ªè—¥æ°´
[31m[1mAssertionError[22m: expected "vi.fn()" to be called with arguments: [ Array(2) ][90m

Received: 

[1m  1st vi.fn() call:

[22m[2m  [[22m
[2m    "/api/potions/use/brain-boost",[22m
[2m    {[22m
[2m      "body": {[22m
[2m        "characterId": "char-001",[22m
[31m+       "idempotencyKey": "1764136336734-dl7yuif",[90m
[2m      },[22m
[2m      "method": "POST",[22m
[2m    },[22m
[2m  ][22m

[1m  2nd vi.fn() call:

[22m[2m  [[22m
[32m-   "/api/potions/use/brain-boost",[90m
[31m+   "/api/potions/active",[90m
[2m    {[22m
[32m-     "body": {[90m
[32m-       "characterId": "char-001",[90m
[32m-     },[90m
[32m-     "method": "POST",[90m
[31m+     "skipGlobalLoading": true,[90m
[2m    },[22m
[2m  ][22m

[1m  3rd vi.fn() call:

[22m[2m  [[22m
[32m-   "/api/potions/use/brain-boost",[90m
[31m+   "/api/users/user-123/assets",[90m
[2m    {[22m
[32m-     "body": {[90m
[32m-       "characterId": "char-001",[90m
[32m-     },[90m
[32m-     "method": "POST",[90m
[31m+     "skipGlobalLoading": true,[90m
[2m    },[22m
[2m  ][22m
[31m[90m

Number of calls: [1m3[22m
[31m[39m
[36m [2mâ¯[22m src/composables/chat/usePotionManagement.spec.ts:[2m304:32[22m[39m
    [90m302| [39m
    [90m303| [39m      [34mexpect[39m(result)[33m.[39m[34mtoBe[39m([35mtrue[39m)[33m;[39m
    [90m304| [39m      [34mexpect[39m(apiUtils[33m.[39mapiJson)[33m.[39m[34mtoHaveBeenCalledWith[39m(
    [90m   | [39m                               [31m^[39m
    [90m305| [39m        [32m'/api/potions/use/brain-boost'[39m[33m,[39m
    [90m306| [39m        {

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[2/3]â¯[22m[39m

[41m[1m FAIL [22m[49m src/composables/chat/usePotionManagement.spec.ts[2m > [22musePotionManagement - è—¥æ°´ç®¡ç†æ¸¬è©¦[2m > [22mé‚Šç•Œæƒ…æ³[2m > [22mæ‡‰è©²è™•ç†éæ¨™æº–éŒ¯èª¤å°è±¡
[31m[1mAssertionError[22m: expected "vi.fn()" to be called with arguments: [ 'ä½¿ç”¨è—¥æ°´å¤±æ•—' ][90m

Received: 

[1m  1st vi.fn() call:

[22m[2m  [[22m
[32m-   "ä½¿ç”¨è—¥æ°´å¤±æ•—",[90m
[31m+   "å­—ç¬¦ä¸²éŒ¯èª¤",[90m
[2m  ][22m
[31m[90m

Number of calls: [1m1[22m
[31m[39m
[36m [2mâ¯[22m src/composables/chat/usePotionManagement.spec.ts:[2m578:34[22m[39m
    [90m576| [39m
    [90m577| [39m      [34mexpect[39m(result)[33m.[39m[34mtoBe[39m([35mfalse[39m)[33m;[39m
    [90m578| [39m      [34mexpect[39m(mockDeps[33m.[39mshowError)[33m.[39m[34mtoHaveBeenCalledWith[39m([32m'ä½¿ç”¨è—¥æ°´å¤±æ•—'[39m)[33m;[39m
    [90m   | [39m                                 [31m^[39m
    [90m579| [39m    })[33m;[39m
    [90m580| [39m  })[33m;[39m

[31m[2mâ¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[3/3]â¯[22m[39m


[2m Test Files [22m [1m[31m1 failed[39m[22m[90m (1)[39m
[2m      Tests [22m [1m[31m3 failed[39m[22m[2m | [22m[1m[32m27 passed[39m[22m[90m (30)[39m
[2m   Start at [22m 13:52:16
[2m   Duration [22m 483ms[2m (transform 71ms, setup 0ms, collect 106ms, tests 110ms, environment 164ms, prepare 6ms)[22m

